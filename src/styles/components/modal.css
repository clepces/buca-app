/* ==========================================================================
   MODAL COMPONENT - VERSIÓN FINAL ORGANIZADA V5
   ========================================================================== */

/* 1. CONTENEDOR BASE */
.modal {
    display: none;
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    background-color: rgba(7, 20, 55, 0.8);
    z-index: 10000;
    backdrop-filter: blur(4px);
    padding: 1rem;
    justify-content: center;
    align-items: center;
    opacity: 0;
    animation: fadeInModal 0.2s ease-out forwards;
}

@keyframes fadeInModal { from { opacity: 0; } to { opacity: 1; } }

.modal-content {
    background-color: var(--bs-body-bg);
    margin: auto;
    border-radius: 16px;
    box-shadow: 0 20px 50px rgba(0,0,0,0.3);
    display: flex;
    flex-direction: column;
    overflow: hidden;
    transform: scale(0.95);
    animation: scaleInModal 0.3s cubic-bezier(0.16, 1, 0.3, 1) forwards;
    max-height: 95vh;
    width: 100%;
}

@keyframes scaleInModal { to { transform: scale(1); } }

/* --- TAMAÑOS (ESTO ARREGLA EL MODAL GIGANTE) --- */
.modal-content.modal-lg { max-width: 980px; } /* Tasa, Productos */
.modal-content.modal-sm { max-width: 480px; text-align: center; } /* Confirmación */

/* --------------------------------------------------------------------------
   2. HEADER, BODY Y FOOTER (GENÉRICOS)
   -------------------------------------------------------------------------- */
/* 2. PARTES DEL MODAL */
.modal-header {
    padding: 1.25rem 1.5rem;
    border-bottom: 1px solid var(--bs-border-color);
    display: flex; justify-content: space-between; align-items: center;
    background-color: var(--bs-card-bg);
}
.modal-title { font-size: 1.25rem; font-weight: 700; color: var(--bs-heading-color); margin: 0; }
.close { background: none; border: none; font-size: 1.5rem; cursor: pointer; color: var(--bs-gray-400); }
.close:hover { color: var(--error-color); }

.modal-body {
    padding: 1rem 1.5rem 0rem 1.5rem;
    flex-grow: 1;
    overflow-y: auto;
    background-color: var(--bs-body-bg);
}

/* El Modal de Tasa necesita un fondo gris en el cuerpo para contraste */
#rate-update-modal .modal-body {
    background-color: var(--bs-gray-50);
}
.modal-footer {
    padding: 1.25rem 1.5rem;
    border-top: 1px solid var(--bs-border-color);
    background-color: var(--bs-card-bg);
    display: flex; justify-content: flex-end; gap: 1rem;
}

.modal-content.modal-sm .modal-footer { justify-content: center; }

/* --------------------------------------------------------------------------
   3. ESTILOS ESPECÍFICOS: GESTIÓN DE TASA (RATE MODAL)
   -------------------------------------------------------------------------- */

/* Header Widget (Reloj y Wifi) */
/* 3. ESTILOS ESPECÍFICOS: TASA (NO TOCAR) */
.header-status-widget {
    display: flex; align-items: center; gap: 1rem; font-size: 0.85rem;
    background-color: var(--bs-gray-50); padding: 0.35rem 0.75rem;
    border-radius: 20px; border: 1px solid var(--bs-border-color); margin-right: 1rem;
}
.status-clock { font-variant-numeric: tabular-nums; font-weight: 600; color: var(--bs-gray-600); }
.status-wifi.online { color: var(--bs-success); }
.status-wifi.offline { color: var(--error-color); animation: pulse 2s infinite; }

/* Layout Grid */
.rate-modal-grid { display: grid; grid-template-columns: 1.2fr 1fr; gap: 1.5rem; align-items: start; }

/* Tarjetas Tasa */
.rate-hero-card, .manual-input-card, .history-panel-card {
    background: var(--bs-card-bg); border: 1px solid var(--bs-border-color); border-radius: 16px; overflow: hidden;
}

.rate-control-panel { display: flex; flex-direction: column; gap: 1rem; height: 100%; }


.rate-hero-card { padding: 2rem; text-align: center; position: relative; height: 100%; }
.rate-hero-card::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 5px; background: linear-gradient(90deg, var(--primary-color), var(--bs-cyan)); }
.hero-badge { display: inline-flex; padding: 0.3rem 0.8rem; background: var(--primary-color); color: white; border-radius: 20px; font-size: 0.75rem; font-weight: 700; text-transform: uppercase; margin-bottom: 1rem; }
.hero-amount { font-size: 3.5rem; font-weight: 800; color: var(--bs-heading-color); line-height: 1; letter-spacing: -1px; }
.hero-date { font-size: 0.9rem; color: var(--bs-gray-500); margin-top: 0.5rem; }

/* Tasa Manual */
.manual-input-card { padding: 1.5rem; margin-top: 1.5rem;  height: 100%;}
.manual-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; }
.manual-header h5 { margin: 0; font-size: 1rem; font-weight: 600; color: var(--bs-gray-700); }

.fintech-input-group { position: relative; }
.fintech-input-group span { position: absolute; left: 1rem; top: 50%; transform: translateY(-50%); font-size: 1.2rem; font-weight: 600; color: var(--bs-gray-400); }
.fintech-input-group input { width: 100%; padding: 0.8rem 1rem 0.8rem 2.5rem; font-size: 1.4rem; font-weight: 700; border: 2px solid var(--bs-border-color); border-radius: 12px; background: var(--bs-gray-50); }

/* Historial */
.history-panel-card { height: 100%; display: flex; flex-direction: column; }
.history-header-panel {
    padding: 1.25rem; border-bottom: 1px solid var(--bs-border-color); background-color: var(--bs-gray-50);
}
.history-header-panel h5 { margin: 0; font-size: 0.95rem; font-weight: 700; text-transform: uppercase; }
.history-list { list-style: none; padding: 0; margin: 0; overflow-y: auto; max-height: 380px; }
.history-item {
    display: flex; justify-content: space-between; align-items: center;
    padding: 1rem 1.25rem; border-bottom: 1px solid var(--bs-border-color);
}
.history-item.is-active-day { background-color: rgba(37, 99, 235, 0.05); position: relative; }
.history-item.is-active-day::before {
    content: ''; position: absolute; left: 0; top: 0; bottom: 0; width: 4px; background-color: var(--primary-color);
}
.day-name { font-weight: 700; color: var(--bs-heading-color); font-size: 0.95rem; text-transform: capitalize; }
.full-date { font-size: 0.75rem; color: var(--bs-gray-500); display: block; }
.rate-val { font-family: 'Roboto Mono', monospace; font-size: 1rem; font-weight: 700; color: var(--bs-heading-color); }
.day-badge {
    font-size: 0.65rem; padding: 2px 6px; border-radius: 4px; font-weight: 700; text-transform: uppercase; margin-left: 0.5rem;
}
.day-badge.tomorrow { background-color: var(--bs-indigo); color: white; }
.day-badge.today { background-color: var(--bs-success); color: white; }
.rate-change { font-size: 0.75rem; font-weight: 600; display: flex; align-items: center; gap: 2px; justify-content: flex-end;}
.rate-change.positive { color: var(--bs-success); }
.rate-change.negative { color: var(--error-color); }

/* --------------------------------------------------------------------------
   4. RESPONSIVE
   -------------------------------------------------------------------------- */
   @media (max-width: 768px) {
    .rate-modal-grid { grid-template-columns: 1fr; }
    .header-status-widget { display: none; }
}

/* Dark Mode */
[data-bs-theme="dark"] .modal-header, [data-bs-theme="dark"] .modal-footer, 
[data-bs-theme="dark"] .rate-hero-card, [data-bs-theme="dark"] .manual-input-card, 
[data-bs-theme="dark"] .history-panel-card, [data-bs-theme="dark"] .history-header-panel {
    background-color: var(--bs-card-bg);
}
[data-bs-theme="dark"] #rate-update-modal .modal-body { background-color: #15171e; }
[data-bs-theme="dark"] .fintech-input-group input { background-color: rgba(0,0,0,0.2); border-color: var(--bs-gray-700); }
[data-bs-theme="dark"] .header-status-widget { background-color: rgba(255,255,255,0.05); }